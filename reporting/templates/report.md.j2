# üîí Secret Detection Report

**Generated:** {{ timestamp }}  
**Target:** {{ scan_target }}  
**Total Findings:** {{ total_findings }}

---

## Executive Summary

Scanned **{{ scan_target }}** and detected **{{ total_findings }}** potential secrets that require immediate attention.

### Severity Breakdown

{% for severity, count in by_severity.items() %}
{% if severity == "critical" %}üî¥{% elif severity == "high" %}üü†{% elif severity == "medium" %}üü°{% else %}üü¢{% endif %} **{{ severity|capitalize }}**: {{ count }} findings
{% endfor %}

### Top Secret Types

{% for secret_type, count in by_type.items()|sort(attribute=1, reverse=true)|list[:10] %}
- **{{ secret_type }}**: {{ count }} occurrences
{% endfor %}

### Most Affected Files

{% for file_path, count in top_files[:10] %}
- `{{ file_path }}`: {{ count }} secrets
{% endfor %}

---

## Detailed Findings

{% for severity in ["critical", "high", "medium", "low"] %}
{% set severity_findings = findings|selectattr("severity", "equalto", severity)|list %}
{% if severity_findings %}

### {{ severity|capitalize }} Severity ({{ severity_findings|length }} findings)

{% for finding in severity_findings[:20] %}
#### Finding #{{ loop.index }}

- **Type**: `{{ finding.type }}`
- **File**: `{{ finding.file }}`
- **Line**: {{ finding.line }}
- **Column**: {{ finding.column }}
- **Description**: {{ finding.description }}
- **Value**: `{{ finding.value }}` (masked)
{% if finding.commit %}
- **Commit**: {{ finding.commit }}
{% endif %}
{% if finding.author %}
- **Author**: {{ finding.author }}
{% endif %}
{% if finding.date %}
- **Date**: {{ finding.date }}
{% endif %}
- **Confidence**: {{ "%.0f"|format(finding.confidence * 100) }}%

{% if finding.context %}
**Context:**
```
{{ finding.context }}
```
{% endif %}

{% endfor %}
{% if severity_findings|length > 20 %}
*... and {{ severity_findings|length - 20 }} more {{ severity }} findings not shown*
{% endif %}
{% endif %}
{% endfor %}

---

## Remediation Recommendations

{% if by_severity.get('critical', 0) > 0 %}
### üî¥ Critical Actions Required

1. **Immediately rotate** all critical secrets detected
2. **Audit access logs** for any unauthorized usage
3. **Enable MFA** on all affected accounts
4. **Review IAM policies** and apply principle of least privilege
5. **Notify security team** about the exposure

{% endif %}
{% if by_severity.get('high', 0) > 0 %}
### üü† High Priority Actions

1. **Rotate secrets** within 24 hours
2. **Implement secret management solution** (e.g., HashiCorp Vault, AWS Secrets Manager, Azure Key Vault)
3. **Add pre-commit hooks** to prevent future secret commits
4. **Review commit history** for other potential exposures

{% endif %}
### üìã General Best Practices

1. **Use environment variables** for sensitive configuration
2. **Implement secret scanning** in CI/CD pipeline
3. **Regular security training** for development team
4. **Document secret management procedures**
5. **Regular audits** of repository access and secrets
6. **Use `.gitignore`** to exclude sensitive files
7. **Implement code review process** with security checks
8. **Use secret management tools** instead of hardcoding

---

## Rotation Status

{% if rotations %}
{% for rotation in rotations %}
{% if rotation.success %}‚úÖ{% else %}‚ùå{% endif %} **{{ rotation.type }}**: {{ rotation.message }}
{% endfor %}
{% else %}
‚ö†Ô∏è No automatic rotation performed. Please rotate secrets manually or use the rotation commands.
{% endif %}

---

## Next Steps

1. **Review all findings** and prioritize based on severity
2. **Rotate compromised credentials** immediately
3. **Remove secrets from code** and commit history
4. **Implement secret management** solution
5. **Add automated scanning** to prevent future exposures
6. **Train team** on secure coding practices

---

## Tools and Commands

### Rotate AWS Credentials
```bash
secretctl rotate aws <access-key-id> --user <username>
```

### Rotate Azure Service Principal
```bash
secretctl rotate azure <service-principal-id> --validity-days 90
```

### Rotate GitHub Tokens
```bash
secretctl rotate github pat --token <token>
secretctl rotate github deploy-key --repo owner/repo
```

### Continuous Monitoring
```bash
# Add to CI/CD pipeline
secretctl scan local . --output json --save-report

# Scan GitHub organization regularly
secretctl scan org <org-name> --max-repos 100
```

---

*Report generated by Secret Detection & Rotation Framework v1.0.0*  
*For more information, visit the [project documentation](https://github.com/your-org/secret-framework)*
